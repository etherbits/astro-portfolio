---
import type { HTMLAttributes } from "astro/types";
interface Props extends HTMLAttributes<"svg"> {}

const { props } = Astro;
---

<canvas home-waves-right {...props}> </canvas>

<script>
  const waveLines = {
    homeRight: {
      viewBox: "0 0 1460 1068",
      lines: [
        [
          [0.6875345821325648, 0.0009699321047526673],
          [
            0.6288170028818444, 0.12075654704170707, 0.45662680115273774,
            0.13821532492725508, 0.44906195965417867, 0.28419010669253153,
          ],
          [
            0.43827809798270895, 0.4922725509214355, 0.37161239193083573,
            0.4277400581959263, 0.2930821325648415, 0.533462657613967,
          ],
          [
            0.20698703170028818, 0.6493695441319107, 0.31829827089337176,
            0.7095053346265762, 0.08919164265129684, 0.7245392822502424,
          ],
          [
            0.055449783861671466, 0.7274490785645005, -0.0092235590778098,
            0.7428709990300679, 0.0020156051873198846, 0.7812803103782735,
          ],
        ],
        [
          [0.7048061959654178, 0.009399117361784675],
          [
            0.6491592219020172, 0.12997090203685743, 0.4706909221902017,
            0.14322696411251212, 0.46437824207492795, 0.2928040737148399,
          ],
          [
            0.45494236311239195, 0.5008467507274491, 0.3815489913544669,
            0.42993404461687684, 0.30812391930835736, 0.5395596508244422,
          ],
          [
            0.22729682997118156, 0.6575926285160039, 0.32444452449567723,
            0.7088128031037827, 0.10236383285302593, 0.7358089233753637,
          ],
          [
            0.06961829971181556, 0.7433375363724539, 0.0032454610951008645,
            0.7549718719689622, 0.014484654178674353, 0.7933811833171678,
          ],
        ],
        [
          [0.7220821325648416, 0.017828322017458778],
          [
            0.6695036023054755, 0.13918525703200776, 0.4847564841498559,
            0.1482376333656644, 0.4796959654178674, 0.3014180407371484,
          ],
          [
            0.4716080691642651, 0.5094209505334626, 0.39148775216138326,
            0.4321280310378274, 0.3231671469740634, 0.5456556741028128,
          ],
          [
            0.24760806916426514, 0.665815712900097, 0.3305914985590778,
            0.7081193016488846, 0.11553746397694525, 0.747078564500485,
          ],
          [
            0.08378818443804034, 0.7592259941804074, 0.0157157060518732,
            0.7670727449078564, 0.02695489913544669, 0.8054820562560621,
          ],
        ],
        [
          [0.7393515850144092, 0.026257419980601358],
          [
            0.6898479827089338, 0.1483996120271581, 0.49882348703170026,
            0.15324927255092144, 0.49501512968299716, 0.31003200775945683,
          ],
          [
            0.48827449567723347, 0.5179951503394762, 0.40142723342939485,
            0.4343220174587779, 0.33821181556195967, 0.5517526673132881,
          ],
          [
            0.2679200288184438, 0.6740378273520854, 0.3367406340057637,
            0.7074267701260911, 0.12871181556195965, 0.7583482056256062,
          ],
          [
            0.09795893371757926, 0.7751144519883608, 0.028187103746397695,
            0.7791745877788554, 0.03942629682997118, 0.8175838991270611,
          ],
        ],
        [
          [0.756628242074928, 0.03468661493695441],
          [
            0.7101945244956772, 0.15761396702230843, 0.5128912103746398,
            0.15826091173617846, 0.5103350144092219, 0.31864597478176526,
          ],
          [
            0.5049423631123919, 0.5265693501454899, 0.41136815561959655,
            0.43651600387972844, 0.353257204610951, 0.5578496605237634,
          ],
          [
            0.28823342939481267, 0.6822609117361784, 0.34288976945244953,
            0.7067342386032978, 0.14188760806916426, 0.7696178467507274,
          ],
          [
            0.11213112391930836, 0.7910029097963143, 0.04065951008645533,
            0.7912754607177497, 0.051898703170028815, 0.8296847720659554,
          ],
        ],
        [
          [0.7739048991354467, 0.04311580989330747],
          [
            0.7305403458213257, 0.16682832201745879, 0.5269603746397695,
            0.16327158098933076, 0.525657060518732, 0.3272599418040737,
          ],
          [
            0.5216116714697406, 0.5351435499515034, 0.4213097982708934,
            0.438709990300679, 0.3683047550432277, 0.5639466537342386,
          ],
          [
            0.3085482708933717, 0.6904839961202716, 0.34904106628242076,
            0.7060417070805043, 0.15506556195965418, 0.7808874878758487,
          ],
          [
            0.12630403458213257, 0.8068913676042677, 0.05313364553314121,
            0.803376333656644, 0.06437283861671471, 0.8417856450048496,
          ],
        ],
        [
          [0.7911815561959655, 0.05154490785645005],
          [
            0.750893371757925, 0.17604267701260912, 0.5410302593659942,
            0.16828322017458777, 0.540978386167147, 0.33587390882638213,
          ],
          [
            0.5382809798270893, 0.543717749757517, 0.4312528818443804,
            0.44090300678952477, 0.3833515850144092, 0.5700426770126091,
          ],
          [
            0.32886383285302595, 0.6987070805043647, 0.355193083573487,
            0.7053482056256063, 0.168242795389049, 0.79215712900097,
          ],
          [
            0.14047838616714697, 0.822779825412221, 0.06560799711815563,
            0.8154772065955382, 0.07684726224783862, 0.8538865179437439,
          ],
        ],
        [
          [0.8084654178674352, 0.059974199806013574],
          [
            0.7712391930835735, 0.18525703200775945, 0.5551008645533141,
            0.17329485935984482, 0.5563018731988473, 0.34448787584869056,
          ],
          [
            0.5549517291066283, 0.5522929194956353, 0.44119596541786743,
            0.4430969932104753, 0.398399855907781, 0.5761396702230844,
          ],
          [
            0.3491801152737752, 0.7069301648884578, 0.36134510086455335,
            0.7046556741028128, 0.181421469740634, 0.8034267701260911,
          ],
          [
            0.15465273775216137, 0.8386682832201746, 0.0780835734870317,
            0.8275780795344325, 0.08932276657060519, 0.8659873908826382,
          ],
        ],
        [
          [0.8257420749279539, 0.06840329776915616],
          [
            0.791592219020173, 0.1944713870029098, 0.569172190201729,
            0.1783055286129971, 0.5716253602305476, 0.35310184287099905,
          ],
          [
            0.5716231988472622, 0.5608671193016489, 0.45114048991354466,
            0.44529097963142583, 0.41344956772334296, 0.5822366634335596,
          ],
          [
            0.36949639769452447, 0.7151522793404461, 0.3674985590778098,
            0.7039631425800194, 0.19460086455331413, 0.8146964112512124,
          ],
          [
            0.168828530259366, 0.8545567410281281, 0.09055907780979827,
            0.8396799224054317, 0.10179827089337175, 0.8780892337536372,
          ],
        ],
        [
          [0.8430187319884725, 0.07683249272550921],
          [
            0.8119380403458214, 0.20368574199806014, 0.5832442363112392,
            0.18331716779825413, 0.586949567723343, 0.3617158098933074,
          ],
          [
            0.5882946685878963, 0.5694413191076625, 0.4610850144092219,
            0.44748496605237637, 0.4284992795389049, 0.5883326867119302,
          ],
          [
            0.38981484149855905, 0.7233753637245393, 0.3736527377521614,
            0.7032696411251212, 0.20778097982708932, 0.8259660523763337,
          ],
          [
            0.1830050432276657, 0.8704451988360814, 0.10303602305475505,
            0.8517807953443259, 0.11427521613832853, 0.8901901066925315,
          ],
        ],
        [
          [0.8603025936599423, 0.08526168768186226],
          [
            0.8322910662824208, 0.21290009699321047, 0.5973177233429395,
            0.18832880698351115, 0.6022752161383285, 0.3703297769156159,
          ],
          [
            0.6049675792507205, 0.578015518913676, 0.47103097982708936,
            0.4496789524733269, 0.443549711815562, 0.5944296799224054,
          ],
          [
            0.41013328530259363, 0.7315984481086324, 0.37980763688760805,
            0.7025771096023278, 0.22096253602305477, 0.837235693501455,
          ],
          [
            0.19718227665706053, 0.8863336566440349, 0.11551368876080692,
            0.8638816682832202, 0.1267528818443804, 0.9022909796314258,
          ],
        ],
        [
          [0.877586455331412, 0.09369078564500485],
          [
            0.8526440922190202, 0.22211445198836083, 0.6113912103746397,
            0.19333947623666342, 0.6176008645533141, 0.3789427740058196,
          ],
          [
            0.6216412103746397, 0.5865897187196896, 0.4809776657060519,
            0.4518729388942774, 0.45860158501440923, 0.6005266731328808,
          ],
          [
            0.4304524495677233, 0.7398215324927255, 0.38596325648414986,
            0.7018845780795344, 0.2341440922190202, 0.8485053346265761,
          ],
          [
            0.21135951008645534, 0.9022211445198837, 0.1279920749279539,
            0.8759825412221145, 0.13923126801152735, 0.9143918525703202,
          ],
        ],
        [
          [0.8948703170028818, 0.10212027158098934],
          [
            0.8729971181556196, 0.23132880698351116, 0.6254661383285303,
            0.19835111542192047, 0.63292795389049, 0.38755674102812804,
          ],
          [
            0.6383162824207492, 0.5951639185257033, 0.4909257925072046,
            0.4540669253152279, 0.4736541786743516, 0.606623666343356,
          ],
          [
            0.45077305475504326, 0.7480436469447138, 0.39212031700288186,
            0.701192046556741, 0.24732708933717582, 0.8597759456838021,
          ],
          [
            0.22553890489913545, 0.9181096023278371, 0.14047190201729107,
            0.8880834141610088, 0.15171109510086456, 0.9264927255092144,
          ],
        ],
        [
          [0.9121469740634005, 0.11054898157129],
          [
            0.893350144092219, 0.2405431619786615, 0.6395403458213257,
            0.2033627546071775, 0.6482550432276657, 0.39617070805043647,
          ],
          [
            0.6549906340057636, 0.6037381183317168, 0.5008724783861671,
            0.45626091173617844, 0.4887060518731988, 0.6127196896217265,
          ],
          [
            0.47109293948126796, 0.756266731328807, 0.3982759365994236,
            0.700498545101843, 0.2605093659942363, 0.8710455868089234,
          ],
          [
            0.23971757925072046, 0.9339980601357905, 0.15295100864553313,
            0.9001842870999031, 0.16419020172910662, 0.9385935984481086,
          ],
        ],
        [
          [0.9294308357348703, 0.11897866149369545],
          [
            0.9137031700288185, 0.24975751697381182, 0.6536167146974063,
            0.20837342386032978, 0.6635835734870317, 0.40478467507274496,
          ],
          [
            0.6716664265129683, 0.6123123181377303, 0.5108220461095101,
            0.458454898157129, 0.5037600864553314, 0.6188166828322017,
          ],
          [
            0.49141426512968295, 0.7644898157129001, 0.40443443804034584,
            0.6998060135790495, 0.27369380403458216, 0.8823152279340446,
          ],
          [
            0.2538976945244957, 0.9498865179437439, 0.16543155619596542,
            0.9122861299709021, 0.1766707492795389, 0.9506954413191077,
          ],
        ],
        [
          [0.9467146974063401, 0.1274073714839961],
          [
            0.9340561959654179, 0.25897187196896215, 0.6676930835734871,
            0.2133850630455868, 0.6789113832853025, 0.41339864209505334,
          ],
          [
            0.688342939481268, 0.6208865179437439, 0.520770893371758,
            0.4606488845780795, 0.518814121037464, 0.624913676042677,
          ],
          [
            0.511736311239193, 0.7727129000969932, 0.41059221902017295,
            0.699113482056256, 0.28687752161383284, 0.8935848690591658,
          ],
          [
            0.268078530259366, 0.9657749757516975, 0.1779128242074928,
            0.9243870029097964, 0.1891520172910663, 0.9627963142580019,
          ],
        ],
        [
          [0.9639985590778097, 0.13583705140640157],
          [
            0.9544092219020173, 0.26818622696411254, 0.6817701729106629,
            0.21839670223084384, 0.6942406340057636, 0.4220126091173618,
          ],
          [
            0.7050194524495678, 0.6294616876818623, 0.5307204610951008,
            0.4628419010669253, 0.5338688760806917, 0.6310096993210476,
          ],
          [
            0.5320583573487031, 0.7809359844810863, 0.41675144092219024,
            0.6984199806013579, 0.3000626801152738, 0.9048545101842871,
          ],
          [
            0.28225936599423634, 0.9816682832201746, 0.19039409221902018,
            0.9364878758486906, 0.20163328530259367, 0.974898157129001,
          ],
        ],
        [
          [0.9812896253602306, 0.14426576139670222],
          [
            0.9747694524495677, 0.27740058195926287, 0.6958472622478387,
            0.22340737148399611, 0.7095698847262248, 0.4306265761396702,
          ],
          [
            0.721693083573487, 0.6380358874878759, 0.540670749279539,
            0.46503588748787583, 0.5489236311239193, 0.6371066925315227,
          ],
          [
            0.5523811239193084, 0.7891580989330746, 0.4229099423631124,
            0.6977274490785644, 0.3132478386167147, 0.9161241513094084,
          ],
          [
            0.2964402017291066, 0.9975557710960233, 0.20287608069164265,
            0.9485887487875849, 0.21411527377521614, 0.9870029097963143,
          ],
        ],
        [
          [0.9985734870317002, 0.15269544131910767],
          [
            0.9951224783861672, 0.2866149369544132, 0.7099250720461094,
            0.22841901066925316, 0.7248991354466858, 0.4392405431619787,
          ],
          [
            0.7383717579250719, 0.6466100872938894, 0.550621037463977,
            0.46722987390882637, 0.563979106628242, 0.643203685741998,
          ],
          [
            0.5727046109510087, 0.7973811833171678, 0.42906988472622476,
            0.6970349175557711, 0.3264337175792507, 0.9273937924345296,
          ],
          [
            0.31062247838616713, 1.0134432589718718, 0.21535878962536023,
            0.9606896217264792, 0.2265979827089337, 0.9990979631425799,
          ],
        ],
      ],
    },
  };

  const canvas = document.querySelector(
    "[home-waves-right]",
  ) as HTMLCanvasElement;

  const { width, height } = canvas.getBoundingClientRect();

  const animStep = 10;
  const dashLength = Math.sqrt(width * width + height * height);
  console.log(dashLength)

  function initCanvas() {
    canvas.width = +width;
    canvas.height = +height;

    const ctx = canvas.getContext("2d");

    return ctx;
  }

  const paths: Path2D[] = [];

  function scaleSegment(coords: number[]) {
    return coords.map((num, i) => {
      let out = num;
      if (i % 2 === 0) {
        out *= width;
      } else {
        out *= height;
      }
      return out;
    });
  }

  function initLines(ctx: CanvasRenderingContext2D) {
    ctx.setLineDash([dashLength]);
    ctx.lineWidth = 1.5;
    ctx.strokeStyle = "#64748b";
    waveLines.homeRight.lines.forEach((line) => {
      const path = new Path2D();

      const firstSegment = line.shift();
      if (!firstSegment) return;
      const moveSegment = scaleSegment(firstSegment) as [number, number];

      path.moveTo(...moveSegment);
      line.forEach((lineSegment) => {
        const segment = scaleSegment(lineSegment) as [
          number,
          number,
          number,
          number,
          number,
          number,
        ];

        path.bezierCurveTo(...segment);
      });

      console.log(path);
      ctx.stroke(path);

      paths.push(path);
    });
  }

  function drawLines(ctx: CanvasRenderingContext2D, i = 0) {
    i += animStep;

    ctx.lineDashOffset = dashLength - i;
    ctx.clearRect(0, 0, width, height);
    paths.forEach((path) => ctx.stroke(path));

    if (i >= dashLength) return;

    requestAnimationFrame(() => drawLines(ctx, i));
  }

  function attachWaveAnimation() {
    const ctx = initCanvas();

    if (!ctx) {
      console.log("ctx init err");
      return;
    }

    requestAnimationFrame(() => initLines(ctx));
    requestAnimationFrame(() => drawLines(ctx));
  }

  attachWaveAnimation();
</script>

<!-- <svg -->
<!--   width="1460" -->
<!--   height="1068" -->
<!--   viewBox="0 0 1460 1068" -->
<!--   fill="none" -->
<!--   xmlns="http://www.w3.org/2000/svg" -->
<!--   preserveAspectRatio="none" -->
<!--   {...props} -->
<!-- > -->
<!--       <mask id="color-mask" fill="white"> -->
<!--         <g> -->
<!--           <rect width="1460" height="250" x="0" y="0" fill="white"/>  -->
<!--           <animateTransform -->
<!--             attributeName="transform" -->
<!--             attributeType="XML" -->
<!--             type="translate" -->
<!--             values="0,800; 0,-300; 0,800" -->
<!--             keyTimes="0; 0.5; 1" -->
<!--             dur="12s" -->
<!--             repeatCount="indefinite"></animateTransform> -->
<!--         </g> -->
<!--       </mask> -->
<!--   <g id="color" mask="url(#color-mask)"> -->
<!--   <path -->
<!--     opacity="0.1" -->
<!--     d="M954.298 1C872.798 124.5 633.798 142.5 623.298 293C608.33 507.533 515.798 441 406.798 550C287.298 669.5 441.798 731.5 123.798 747C76.9643 750 -12.8023 765.9 2.79766 805.5" -->
<!--     stroke="#BFDBFE" -->
<!--     stroke-opacity="0.6" -->
<!--     stroke-width="2"></path> -->
<!--   <path -->
<!--     opacity="0.2" -->
<!--     d="M978.271 9.69049C901.033 134 653.319 147.667 644.557 301.881C631.46 516.373 529.59 443.262 427.676 556.286C315.488 677.978 450.329 730.786 142.081 758.619C96.6302 766.381 4.5047 778.376 20.1047 817.976" -->
<!--     stroke="#BFDBFE" -->
<!--     stroke-opacity="0.6" -->
<!--     stroke-width="2"></path> -->
<!--   <path -->
<!--     opacity="0.3" -->
<!--     d="M1002.25 18.381C929.271 143.5 672.842 152.833 665.818 310.762C654.592 525.213 543.385 445.524 448.556 562.571C343.68 686.456 458.861 730.071 160.366 770.238C116.298 782.762 21.8134 790.852 37.4134 830.452" -->
<!--     stroke="#BFDBFE" -->
<!--     stroke-opacity="0.6" -->
<!--     stroke-width="2"></path> -->
<!--   <path -->
<!--     opacity="0.4" -->
<!--     d="M1026.22 27.0714C957.509 153 692.367 158 687.081 319.643C677.725 534.053 557.181 447.786 469.438 568.857C371.873 694.933 467.396 729.357 178.652 781.857C135.967 799.143 39.1237 803.329 54.7237 842.929" -->
<!--     stroke="#BFDBFE" -->
<!--     stroke-opacity="0.6" -->
<!--     stroke-width="2"></path> -->
<!--     </g> -->
<!-- </svg> -->
